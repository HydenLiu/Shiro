import{r as P,R as nt}from"./index-PHhbi6jb.js";var S={BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0,SSR:!1};let ot=0;function J(t,n){const d=`atom${++ot}`,h={toString:()=>d};return typeof t=="function"?h.read=t:(h.init=t,h.read=function(g){return g(this)},h.write=function(g,l,w){return l(this,typeof w=="function"?w(g(this)):w)}),n&&(h.write=n),h}const D=t=>"init"in t,L=t=>!!t.write,N=new WeakMap,rt=(t,n)=>{N.set(t,n),t.catch(()=>{}).finally(()=>N.delete(t))},x=(t,n)=>{const d=N.get(t);d&&(N.delete(t),d(n))},Y=(t,n)=>{t.status="fulfilled",t.value=n},G=(t,n)=>{t.status="rejected",t.reason=n},st=t=>typeof(t==null?void 0:t.then)=="function",O=(t,n)=>!!t&&"v"in t&&"v"in n&&Object.is(t.v,n.v),H=(t,n)=>!!t&&"e"in t&&"e"in n&&Object.is(t.e,n.e),M=t=>!!t&&"v"in t&&t.v instanceof Promise,it=(t,n)=>"v"in t&&"v"in n&&t.v.orig&&t.v.orig===n.v.orig,T=t=>{if("e"in t)throw t.e;return t.v},ct=()=>{const t=new WeakMap,n=new WeakMap,d=new Map;let h,g;(S?"production":void 0)!=="production"&&(h=new Set,g=new Set);const l=e=>t.get(e),w=(e,r)=>{(S?"production":void 0)!=="production"&&Object.freeze(r);const i=t.get(e);if(t.set(e,r),d.has(e)||d.set(e,i),M(i)){const o="v"in r?r.v instanceof Promise?r.v:Promise.resolve(r.v):Promise.reject(r.e);i.v!==o&&x(i.v,o)}},v=(e,r,i)=>{const o=new Map;let c=!1;i.forEach((f,s)=>{!f&&s===e&&(f=r),f?(o.set(s,f),r.d.get(s)!==f&&(c=!0)):(S?"production":void 0)!=="production"&&console.warn("[Bug] atom state not found")}),(c||r.d.size!==o.size)&&(r.d=o)},_=(e,r,i)=>{const o=l(e),c={d:(o==null?void 0:o.d)||new Map,v:r};if(i&&v(e,c,i),O(o,c)&&o.d===c.d)return o;if(M(o)&&M(c)&&it(o,c)){if(o.d===c.d)return o;c.v=o.v}return w(e,c),c},E=(e,r,i,o)=>{if(st(r)){let c;const f=()=>{const u=l(e);if(!M(u)||u.v!==s)return;const A=_(e,s,i);n.has(e)&&u.d!==A.d&&F(e,A,u.d)},s=new Promise((u,A)=>{let a=!1;r.then(p=>{a||(a=!0,Y(s,p),u(p),f())},p=>{a||(a=!0,G(s,p),A(p),f())}),c=p=>{a||(a=!0,p.then(b=>Y(s,b),b=>G(s,b)),u(p))}});return s.orig=r,s.status="pending",rt(s,u=>{u&&c(u),o==null||o()}),_(e,s,i)}return _(e,r,i)},m=(e,r,i)=>{const o=l(e),c={d:(o==null?void 0:o.d)||new Map,e:r};return i&&v(e,c,i),H(o,c)&&o.d===c.d?o:(w(e,c),c)},y=(e,r)=>{const i=l(e);if(!r&&i&&(n.has(e)||Array.from(i.d).every(([a,p])=>{if(a===e)return!0;const b=y(a);return b===p||O(b,p)})))return i;const o=new Map;let c=!0;const f=a=>{if(a===e){const b=l(a);if(b)return o.set(a,b),T(b);if(D(a))return o.set(a,void 0),a.init;throw new Error("no atom init")}const p=y(a);return o.set(a,p),T(p)};let s,u;const A={get signal(){return s||(s=new AbortController),s.signal},get setSelf(){return(S?"production":void 0)!=="production"&&!L(e)&&console.warn("setSelf function cannot be used with read-only atom"),!u&&L(e)&&(u=(...a)=>{if((S?"production":void 0)!=="production"&&c&&console.warn("setSelf function cannot be called in sync"),!c)return I(e,...a)}),u}};try{const a=e.read(f,A);return E(e,a,o,()=>s==null?void 0:s.abort())}catch(a){return m(e,a,o)}finally{c=!1}},W=e=>T(y(e)),Q=e=>{let r=n.get(e);return r||(r=j(e)),r},C=(e,r)=>!r.l.size&&(!r.t.size||r.t.size===1&&r.t.has(e)),tt=e=>{const r=n.get(e);r&&C(e,r)&&V(e)},z=e=>{const r=new Map,i=new WeakMap,o=s=>{var u;const A=new Set((u=n.get(s))==null?void 0:u.t);return d.forEach((a,p)=>{var b;(b=l(p))!=null&&b.d.has(s)&&A.add(p)}),A},c=s=>{o(s).forEach(u=>{u!==s&&(r.set(u,(r.get(u)||new Set).add(s)),i.set(u,(i.get(u)||0)+1),c(u))})};c(e);const f=s=>{o(s).forEach(u=>{var A;if(u!==s){let a=i.get(u);if(a&&i.set(u,--a),!a){let p=!!((A=r.get(u))!=null&&A.size);if(p){const b=l(u),et=y(u,!0);p=!O(b,et)}p||r.forEach(b=>b.delete(u))}f(u)}})};f(e)},$=(e,...r)=>{let i=!0;const o=s=>T(y(s)),c=(s,...u)=>{let A;if(s===e){if(!D(s))throw new Error("atom not writable");const a=l(s),p=E(s,u[0]);O(a,p)||z(s)}else A=$(s,...u);if(!i){const a=R();(S?"production":void 0)!=="production"&&h.forEach(p=>p({type:"async-write",flushed:a}))}return A},f=e.write(o,c,...r);return i=!1,f},I=(e,...r)=>{const i=$(e,...r),o=R();return(S?"production":void 0)!=="production"&&h.forEach(c=>c({type:"write",flushed:o})),i},j=(e,r,i)=>{var o;const c=i||[];(o=l(e))==null||o.d.forEach((s,u)=>{const A=n.get(u);A?A.t.add(e):u!==e&&j(u,e,c)}),y(e);const f={t:new Set(r&&[r]),l:new Set};if(n.set(e,f),(S?"production":void 0)!=="production"&&g.add(e),L(e)&&e.onMount){const{onMount:s}=e;c.push(()=>{const u=s((...A)=>I(e,...A));u&&(f.u=u)})}return i||c.forEach(s=>s()),f},V=e=>{var r;const i=(r=n.get(e))==null?void 0:r.u;i&&i(),n.delete(e),(S?"production":void 0)!=="production"&&g.delete(e);const o=l(e);o?(M(o)&&x(o.v),o.d.forEach((c,f)=>{if(f!==e){const s=n.get(f);s&&(s.t.delete(e),C(f,s)&&V(f))}})):(S?"production":void 0)!=="production"&&console.warn("[Bug] could not find atom state to unmount",e)},F=(e,r,i)=>{const o=new Set(r.d.keys()),c=new Set;i==null||i.forEach((f,s)=>{if(o.has(s)){o.delete(s);return}c.add(s);const u=n.get(s);u&&u.t.delete(e)}),o.forEach(f=>{const s=n.get(f);s?s.t.add(e):n.has(e)&&j(f,e)}),c.forEach(f=>{const s=n.get(f);s&&C(f,s)&&V(f)})},R=()=>{let e;for((S?"production":void 0)!=="production"&&(e=new Set);d.size;){const r=Array.from(d);d.clear(),r.forEach(([i,o])=>{const c=l(i);if(c){const f=n.get(i);f&&c.d!==(o==null?void 0:o.d)&&F(i,c,o==null?void 0:o.d),f&&!(!M(o)&&(O(o,c)||H(o,c)))&&(f.l.forEach(s=>s()),(S?"production":void 0)!=="production"&&e.add(i))}else(S?"production":void 0)!=="production"&&console.warn("[Bug] no atom state to flush")})}if((S?"production":void 0)!=="production")return e},q=(e,r)=>{const i=Q(e),o=R(),c=i.l;return c.add(r),(S?"production":void 0)!=="production"&&h.forEach(f=>f({type:"sub",flushed:o})),()=>{c.delete(r),tt(e),(S?"production":void 0)!=="production"&&h.forEach(f=>f({type:"unsub"}))}};return(S?"production":void 0)!=="production"?{get:W,set:I,sub:q,dev_subscribe_store:(e,r)=>{if(r!==2)throw new Error("The current StoreListener revision is 2.");return h.add(e),()=>{h.delete(e)}},dev_get_mounted_atoms:()=>g.values(),dev_get_atom_state:e=>t.get(e),dev_get_mounted:e=>n.get(e),dev_restore_atoms:e=>{for(const[i,o]of e)D(i)&&(E(i,o),z(i));const r=R();h.forEach(i=>i({type:"restore",flushed:r}))}}:{get:W,set:I,sub:q}};let U;(S?"production":void 0)!=="production"&&(typeof globalThis.__NUMBER_OF_JOTAI_INSTANCES__=="number"?++globalThis.__NUMBER_OF_JOTAI_INSTANCES__:globalThis.__NUMBER_OF_JOTAI_INSTANCES__=1);const K=()=>(U||((S?"production":void 0)!=="production"&&globalThis.__NUMBER_OF_JOTAI_INSTANCES__!==1&&console.warn("Detected multiple Jotai instances. It may cause unexpected behavior with the default store. https://github.com/pmndrs/jotai/discussions/2044"),U=ct()),U);var ut={BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const dt=P.createContext(void 0),X=t=>{const n=P.useContext(dt);return(t==null?void 0:t.store)||n||K()},ft=t=>typeof(t==null?void 0:t.then)=="function",lt=nt.use||(t=>{if(t.status==="pending")throw t;if(t.status==="fulfilled")return t.value;throw t.status==="rejected"?t.reason:(t.status="pending",t.then(n=>{t.status="fulfilled",t.value=n},n=>{t.status="rejected",t.reason=n}),t)});function at(t,n){const d=X(n),[[h,g,l],w]=P.useReducer(E=>{const m=d.get(t);return Object.is(E[0],m)&&E[1]===d&&E[2]===t?E:[m,d,t]},void 0,()=>[d.get(t),d,t]);let v=h;(g!==d||l!==t)&&(w(),v=d.get(t));const _=n==null?void 0:n.delay;return P.useEffect(()=>{const E=d.sub(t,()=>{if(typeof _=="number"){setTimeout(w,_);return}w()});return w(),E},[d,t,_]),P.useDebugValue(v),ft(v)?lt(v):v}function vt(t,n){const d=X(n);return P.useCallback((...g)=>{if((ut?"production":void 0)!=="production"&&!("write"in t))throw new Error("not writable atom");return d.set(t,...g)},[d,t])}function mt(t,n){return[at(t,n),vt(t,n)]}var Z={BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const ht=Symbol((Z?"production":void 0)!=="production"?"RESET":""),B=(t,n,d)=>(n.has(d)?n:n.set(d,t())).get(d),wt=new WeakMap,_t=(t,n,d,h)=>{const g=B(()=>new WeakMap,wt,n),l=B(()=>new WeakMap,g,d);return B(t,l,h)};function bt(t,n,d=Object.is){return _t(()=>{const h=Symbol(),g=([w,v])=>{if(v===h)return n(w);const _=n(w,v);return d(v,_)?v:_},l=J(w=>{const v=w(l),_=w(t);return _ instanceof Promise||v instanceof Promise?Promise.all([_,v]).then(g):g([_,v])});return l.init=h,l},t,n,d)}const pt=t=>typeof(t==null?void 0:t.then)=="function";function gt(t=()=>typeof window<"u"?window.localStorage:void 0,n){let d,h;const g={getItem:(l,w)=>{var v,_;const E=y=>{if(y=y||"",d!==y){try{h=JSON.parse(y,n==null?void 0:n.reviver)}catch{return w}d=y}return h},m=(_=(v=t())==null?void 0:v.getItem(l))!=null?_:null;return pt(m)?m.then(E):E(m)},setItem:(l,w)=>{var v;return(v=t())==null?void 0:v.setItem(l,JSON.stringify(w,n==null?void 0:n.replacer))},removeItem:l=>{var w;return(w=t())==null?void 0:w.removeItem(l)}};return typeof window<"u"&&typeof window.addEventListener=="function"&&window.Storage&&(g.subscribe=(l,w,v)=>{if(!(t()instanceof window.Storage))return()=>{};const _=E=>{if(E.storageArea===t()&&E.key===l){let m;try{m=JSON.parse(E.newValue||"")}catch{m=v}w(m)}};return window.addEventListener("storage",_),()=>{window.removeEventListener("storage",_)}}),g}const Et=gt();function yt(t,n,d=Et,h){const g=h==null?void 0:h.getOnInit,l=J(g?d.getItem(t,n):n);return(Z?"production":void 0)!=="production"&&(l.debugPrivate=!0),l.onMount=v=>{g||v(d.getItem(t,n));let _;return d.subscribe&&(_=d.subscribe(t,v,n)),_},J(v=>v(l),(v,_,E)=>{const m=typeof E=="function"?E(v(l)):E;return m===ht?(_(l,n),d.removeItem(t)):m instanceof Promise?m.then(y=>(_(l,y),d.setItem(t,y))):(_(l,m),d.setItem(t,m))})}let k,At=()=>{if(k)return k;let t=K();return k=t,t};const Mt=At();export{J as a,vt as b,yt as c,X as d,mt as e,Mt as j,At as o,bt as s,at as u};
